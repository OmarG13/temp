name: SSHExecuteLSWithoutSSHPass
type: CLIENT
description: |
  This artifact uses execve() to SSH into a remote system using a username and password,
  and runs the 'ls' command on a specified directory without requiring sshpass.
parameters:
  - name: ssh_host
    description: Enter the IP address or hostname of the target system
    type: string
  - name: ssh_user
    description: Enter the SSH username
    type: string
  - name: ssh_password
    description: Enter the SSH password
    type: string
  - name: directory
    description: Enter the directory to list (default: home directory)
    type: string
    default: "~"
sources:
  - precondition: |
      SELECT os_type FROM info()
      WHERE os_type = "linux" OR os_type = "darwin"
    query: |
      SELECT * FROM execve(
        args=["bash", "-c", concat(
          "'echo ", ssh_password, " | ssh -tt ",
          ssh_user, "@", ssh_host, " ls ", directory, "'"
        )],
        cwd="",
        stdout=TRUE
      )
